# MediStock iOS - Customers CRUD Tests
# Prerequisites: User must be admin
appId: com.medistock.ios
---

# Setup: Login
- launchApp:
    clearState: true

- waitForAnimationToEnd

- tapOn: "Username"
- inputText: "admin"

- tapOn: "Password"
- inputText: "admin"

- tapOn:
    text: "Login"
    index: 1

- waitForAnimationToEnd:
    timeout: 10000

# Navigate to Administration
- scrollUntilVisible:
    element:
      text: "Administration"
    direction: DOWN

- waitForAnimationToEnd

- tapOn:
    text: "Administration"
    index: 1
    retryTapIfNoChange: true

- waitForAnimationToEnd:
    timeout: 5000

# Navigate to Customers
- tapOn:
    text: "Manage Customers"
    retryTapIfNoChange: true

- waitForAnimationToEnd

# Test 1: Create a new customer
- tapOn:
    text: ".*Add.*"
    optional: true

- waitForAnimationToEnd:
    timeout: 3000

# Fill customer form
- tapOn:
    text: ".*Customer name.*"
    optional: true
- inputText: "Customer E2E Test iOS"

# Save
- tapOn:
    text: "Add"
    optional: true
- tapOn:
    text: "Save"
    optional: true

- waitForAnimationToEnd

# Verify customer appears in list
- assertVisible:
    text: "Customer E2E Test iOS"
    optional: true

- takeScreenshot: "ios_customer_created"

# Test 2: Edit customer
- tapOn:
    text: "Customer E2E Test iOS"
    optional: true

- waitForAnimationToEnd:
    timeout: 3000

# Clear and enter new name
- eraseText: 50
- inputText: "Customer E2E Modified iOS"

# Save
- tapOn:
    text: "Save"
    optional: true

- waitForAnimationToEnd

# Verify modified name
- assertVisible:
    text: "Customer E2E Modified iOS"
    optional: true

- takeScreenshot: "ios_customer_edited"

# Test 3: Delete customer
- longPressOn:
    text: "Customer E2E Modified iOS"
    optional: true

- tapOn:
    text: ".*Delete.*"
    optional: true

# Confirm deletion
- tapOn:
    text: ".*Delete.*"
    optional: true

- waitForAnimationToEnd

- takeScreenshot: "ios_customer_deleted"
