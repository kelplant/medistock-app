# MediStock iOS - Password Complexity Tests
# Prerequisites: User must be logged in as admin
appId: com.medistock.iosApp
---

# Setup: Login as admin
- launchApp:
    clearState: true

- waitForAnimationToEnd:
    timeout: 5000

- tapOn:
    text: ".*Username.*"
    optional: true
- inputText: "admin"

- tapOn:
    text: ".*Password.*"
    optional: true
- inputText: "Admin123!"

- tapOn:
    text: ".*Login.*|.*Sign [Ii]n.*"

- waitForAnimationToEnd:
    timeout: 10000

# Navigate to Administration (if needed based on menu structure)
- tapOn:
    text: ".*Administration.*|.*Admin.*|.*Manage.*"
    optional: true

- waitForAnimationToEnd

# Navigate to Users
- tapOn:
    text: ".*Users.*|.*Utilisateurs.*"
    optional: true

- waitForAnimationToEnd

# Test 1: Try to create user with weak password
- tapOn:
    text: ".*Add.*|.*New.*|.*\\+.*"
    optional: true

- waitForAnimationToEnd

# Fill user form
- tapOn:
    text: ".*Username.*"
    optional: true
- inputText: "weakpwd_ios"

- tapOn:
    text: ".*[Ff]ull [Nn]ame.*|.*Nom complet.*"
    optional: true
- inputText: "Test User iOS"

- tapOn:
    text: ".*Password.*"
    optional: true
- inputText: "abc"

- waitForAnimationToEnd

# Verify password requirements are shown
- assertVisible:
    text: ".*8.*"
    optional: true

- takeScreenshot: "ios_password_weak"

# Test 2: Enter valid password and verify strength indicator
- tapOn:
    text: ".*Password.*"
    optional: true
- eraseText
- inputText: "Test123!"

- waitForAnimationToEnd

# Verify strength indicator shows strong
- assertVisible:
    text: ".*Strong.*|.*Fort.*"
    optional: true

- takeScreenshot: "ios_password_strong"

# Navigate back
- tapOn:
    text: ".*Cancel.*|.*Annuler.*"
    optional: true

- waitForAnimationToEnd

# Test 3: Change password flow
# Go to profile
- tapOn:
    text: ".*Profile.*|.*Profil.*"
    optional: true

- waitForAnimationToEnd

# Navigate to Change Password
- tapOn:
    text: ".*Change.*[Pp]assword.*|.*Changer.*mot de passe.*"
    optional: true

- waitForAnimationToEnd

# Verify password requirements are displayed
- assertVisible:
    text: ".*8.*"
    optional: true

# Enter current password
- tapOn:
    text: ".*[Cc]urrent.*[Pp]assword.*|.*Mot de passe actuel.*"
    optional: true
- inputText: "Admin123!"

# Enter new weak password
- tapOn:
    text: ".*[Nn]ew.*[Pp]assword.*|.*Nouveau mot de passe.*"
    optional: true
- inputText: "weak"

- waitForAnimationToEnd

- takeScreenshot: "ios_change_password_weak"

# Enter strong password
- tapOn:
    text: ".*[Nn]ew.*[Pp]assword.*|.*Nouveau mot de passe.*"
    optional: true
- eraseText
- inputText: "NewStrong123!"

- waitForAnimationToEnd

# Verify strength indicator shows strong
- assertVisible:
    text: ".*Strong.*|.*Fort.*"
    optional: true

- takeScreenshot: "ios_change_password_strong"

# Navigate back
- tapOn:
    text: ".*Back.*|.*Retour.*"
    optional: true

- waitForAnimationToEnd

- takeScreenshot: "ios_password_tests_complete"
