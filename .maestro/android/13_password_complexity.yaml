# MediStock Android - Password Complexity Tests
# Prerequisites: User must be logged in as admin
appId: com.medistock
---

# Setup: Login as admin
- launchApp:
    clearState: true

- waitForAnimationToEnd

- tapOn:
    id: "com.medistock:id/editUsername"
- inputText: "admin"

- tapOn:
    id: "com.medistock:id/editPassword"
- inputText: "Admin123!"

- tapOn:
    id: "com.medistock:id/btnLogin"

- waitForAnimationToEnd:
    timeout: 10000

# Navigate to Administration
- tapOn:
    text: ".*Administration.*"

- waitForAnimationToEnd

# Navigate to User Management
- tapOn:
    text: ".*User Management.*"

- waitForAnimationToEnd

# Test 1: Try to create user with weak password (too short)
- tapOn:
    id: ".*fab.*"
    optional: true

- waitForAnimationToEnd

# Fill user form
- tapOn:
    id: "com.medistock:id/editFullName"
    optional: true
- inputText: "Test User"

- tapOn:
    id: "com.medistock:id/editUsername"
    optional: true
- inputText: "weakpwd_test"

- tapOn:
    id: "com.medistock:id/editPassword"
    optional: true
- inputText: "abc"

- waitForAnimationToEnd

# Verify password requirements are shown
- assertVisible:
    text: ".*8.*"
    optional: true

- takeScreenshot: "android_password_weak"

# Try to save - should fail
- tapOn:
    text: ".*Save.*"
    optional: true

- waitForAnimationToEnd

# Test 2: Enter password without uppercase
- tapOn:
    id: "com.medistock:id/editPassword"
    optional: true
- clearText
- inputText: "abcdefgh1!"

- waitForAnimationToEnd

- takeScreenshot: "android_password_no_uppercase"

# Test 3: Enter valid password and verify strength indicator
- tapOn:
    id: "com.medistock:id/editPassword"
    optional: true
- clearText
- inputText: "Test123!"

- waitForAnimationToEnd

# Verify strength indicator shows strong
- assertVisible:
    text: ".*Strong.*|.*Fort.*|.*Stark.*|.*Fuerte.*"
    optional: true

- takeScreenshot: "android_password_strong"

# Navigate back
- back

- waitForAnimationToEnd

# Test 4: Change password flow
# Go to profile
- tapOn:
    id: "com.medistock:id/profileBadge"
    optional: true

- waitForAnimationToEnd

# Navigate to Change Password
- tapOn:
    text: ".*Change.*[Pp]assword.*|.*Changer.*mot de passe.*"
    optional: true

- waitForAnimationToEnd

# Verify password requirements are displayed
- assertVisible:
    text: ".*8.*"
    optional: true

# Enter current password
- tapOn:
    id: "com.medistock:id/editCurrentPassword"
    optional: true
- inputText: "Admin123!"

# Enter new weak password
- tapOn:
    id: "com.medistock:id/editNewPassword"
    optional: true
- inputText: "weak"

- waitForAnimationToEnd

- takeScreenshot: "android_change_password_weak"

# Enter strong password
- tapOn:
    id: "com.medistock:id/editNewPassword"
    optional: true
- clearText
- inputText: "NewStrong123!"

- waitForAnimationToEnd

# Verify strength indicator shows strong
- assertVisible:
    text: ".*Strong.*|.*Fort.*|.*Stark.*|.*Fuerte.*"
    optional: true

- takeScreenshot: "android_change_password_strong"

# Navigate back
- back
- back

- waitForAnimationToEnd

- takeScreenshot: "android_password_tests_complete"
