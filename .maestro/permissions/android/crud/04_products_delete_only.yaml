# MediStock Android - CRUD Permission Test
# Test User: test_products_delete (canView=true, canCreate=false, canEdit=false, canDelete=true)
# Expected: Can view products and delete them, but cannot add new or edit
appId: com.medistock
---

# Launch app and login
- launchApp:
    clearState: true

- waitForAnimationToEnd

# Login with test_products_delete user
- tapOn:
    id: "com.medistock:id/editUsername"
- inputText: "test_products_delete"

- tapOn:
    id: "com.medistock:id/editPassword"
- inputText: "Test123!"

- tapOn:
    id: "com.medistock:id/btnLogin"

- waitForAnimationToEnd:
    timeout: 10000

# Verify we're on home screen
- assertVisible: "MediStock"

# Navigate to Administration
- tapOn:
    text: ".*Administration.*"

- waitForAnimationToEnd

# Navigate to Manage Products
- assertVisible:
    text: ".*Manage Products.*"

- tapOn:
    text: ".*Manage Products.*"

- waitForAnimationToEnd

# Navigate to Products list
- assertVisible:
    text: ".*Products.*"

- tapOn:
    text: ".*Products.*"

- waitForAnimationToEnd:
    timeout: 5000

# Verify Products list IS visible
- assertVisible:
    text: ".*Products.*"

# Verify FAB (Add button) is NOT visible
- assertNotVisible:
    id: ".*fab.*"
    optional: true

- assertNotVisible:
    text: ".*Add.*"
    optional: true

# Wait for product list to load
- extendedWaitUntil:
    visible:
      id: ".*recyclerView.*|.*listView.*"
    timeout: 10000

# Tap on the first product in the list
- tapOn:
    index: 0

- waitForAnimationToEnd

# Verify Edit button is NOT visible
- assertNotVisible:
    text: ".*Edit.*"
    optional: true

- assertNotVisible:
    id: ".*menu_edit.*|.*action_edit.*"
    optional: true

# Verify Delete button IS visible
- assertVisible:
    text: ".*Delete.*"

# Take screenshot
- takeScreenshot: "android_products_delete_only_detail"
