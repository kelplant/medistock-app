# MediStock Android - Permission Visibility Test
# Test User: test_customers_only
# Expected: Only Customers visible in Admin menu, no operations on Home
appId: com.medistock
---

# Launch app and login
- launchApp:
    clearState: true

- waitForAnimationToEnd

# Login with test_customers_only user
- tapOn:
    id: "com.medistock:id/editUsername"
- inputText: "test_customers_only"

- tapOn:
    id: "com.medistock:id/editPassword"
- inputText: "Test123!"

- tapOn:
    id: "com.medistock:id/btnLogin"

- waitForAnimationToEnd:
    timeout: 10000

# Verify we're on home screen
- assertVisible: "MediStock"

# Verify NO operations are visible on Home Screen
- assertNotVisible:
    text: ".*Purchases.*"
    optional: true

- assertNotVisible:
    text: ".*Sales.*"
    optional: true

- assertNotVisible:
    text: ".*Transfers.*"
    optional: true

- assertNotVisible:
    text: ".*Stock.*"
    optional: true

- assertNotVisible:
    text: ".*Inventory.*"
    optional: true

# Administration should be visible
- assertVisible:
    text: ".*Administration.*"

# Navigate to Administration
- tapOn:
    text: ".*Administration.*"

- waitForAnimationToEnd

# Verify ONLY Customers is visible
- assertVisible:
    text: ".*Manage Customers.*"

# Verify other admin modules are NOT visible
- assertNotVisible:
    text: ".*Site Management.*"
    optional: true

- assertNotVisible:
    text: ".*Manage Products.*"
    optional: true

- assertNotVisible:
    text: ".*Packaging Types.*"
    optional: true

- assertNotVisible:
    text: ".*User Management.*"
    optional: true

- assertNotVisible:
    text: ".*Audit History.*"
    optional: true

# Take screenshot
- takeScreenshot: "android_customers_only_admin"
